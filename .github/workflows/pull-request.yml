
name: Pull Request

on:
  # Always build pull requests
  pull_request:
    branches:
      - '**'

jobs:
  test:
    name: Test
    runs-on: ubuntu-16.04
    steps:
      - uses: actions/checkout@v1
      - name: Test
        run: git diff --name-only $GITHUB_SHA $GITHUB_REF

  # build:
  #   name: Build PR
  #   runs-on: ubuntu-16.04
  #   steps:
  #     - uses: actions/checkout@v1

  #     - name: Install Linuxbrew
  #       run: |
  #         sudo apt-get update && sudo apt-get -y install jq

  #         # Hack: Remove all files from /usr/local/include as any files there which have not been
  #         #  installed by linuxbrew will make `brew doctor` produce warnings
  #         sudo rm -rf /usr/local/include

  #         source ./install-linuxbrew.sh
  #         echo "::set-env name=HOMEBREW_PREFIX::${HOMEBREW_PREFIX}"
  #         echo "::set-env name=HOMEBREW_CELLAR::${HOMEBREW_CELLAR}"
  #         echo "::set-env name=HOMEBREW_REPOSITORY::${HOMEBREW_REPOSITORY}"
  #         echo "::add-path::${HOMEBREW_PREFIX}/bin"
  #         echo "::add-path::${HOMEBREW_PREFIX}/sbin"
  #         # Hack: change permissions for library from 666 to 644 since the umask is not honored
  #         #  yet 'brew audit' requires 644 for the formula file on Linux
  #         # We change permissions for all taps, since brew will lowercase org folder names, so
  #         #  ...SOURCE_ORGANIZATION is not necessarily a valid folder name
  #         chmod -R go-w /home/linuxbrew/.linuxbrew/Homebrew/Library/Taps

  #     - name: Install current PR as tap
  #       run: |
  #         GITHUB_TAP_ORGANIZATON="kalmalyzer"
  #         GITHUB_TAP_REPOSITORY="homebrew-prebuilt-amiga-dev-tools"
  #         HOMEBREW_TAP_DIR="/home/linuxbrew/.linuxbrew/Library/Taps/${GITHUB_TAP_ORGANIZATION}/${GITHUB_TAP_REPOSITORY}"
  #         mkdir -p "${HOMEBREW_TAP_DIR}"
  #         rm -rf "${HOMEBREW_TAP_DIR}"
  #         ln -s "${PWD}" "${HOMEBREW_TAP_DIR}"

  #     - name: Run brew test-bot
  #       run: |
  #         HOMEBREW_DEVELOPER=1
  #         HOMEBREW_NO_AUTO_UPDATE=1
  #         HOMEBREW_NO_EMOJI=1
  #         HOMEBREW_FAIL_LOG_LINES=150
  #         HOMEBREW_COLOR=1
  #         brew test-bot --verbose
 
